# =========================================================
# 游댳 STORIES SIMPLIFICADAS - SIN COMPLETAR_PEDIDO
# =========================================================
# Eliminamos completar_pedido y fortalecemos modificar_busqueda

version: "3.1"

stories:

# -------------------------
# SMALLTALK B츼SICO
# -------------------------
- story: smalltalk_basico
  steps:
  - intent: saludo
  - action: action_smalltalk_situacion
  
- story: smalltalk_chiste
  steps:
  - intent: pedir_chiste
  - action: action_smalltalk_situacion

- story: smalltalk_durante_busqueda
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: pedir_chiste
  - action: action_smalltalk_situacion

# -------------------------
# B칔SQUEDAS DIRECTAS
# -------------------------
- story: busqueda_producto_directa
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion

- story: busqueda_oferta_directa
  steps:
  - intent: buscar_oferta
  - action: action_busqueda_situacion

# -------------------------
# MODIFICAR B칔SQUEDA (REEMPLAZA COMPLETAR_PEDIDO)
# -------------------------
- story: modificar_busqueda_simple
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion

- story: modificar_busqueda_oferta
  steps:
  - intent: buscar_oferta
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion

- story: modificar_tras_sugerencia
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion  # Puede generar sugerencia
  - intent: modificar_busqueda        # Usuario modifica en lugar de responder sugerencia
  - action: action_busqueda_situacion

- story: modificar_multiple
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion
  - intent: modificar_busqueda        # M칰ltiples modificaciones
  - action: action_busqueda_situacion

- story: modificar_cambio_tipo
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: modificar_busqueda        # Puede cambiar criterios completamente
  - action: action_busqueda_situacion

# -------------------------
# RECOMENDACIONES
# -------------------------
- story: recomendaciones_producto
  steps:
  - intent: consultar_recomendaciones_producto
  - action: action_recomendaciones

- story: recomendaciones_oferta
  steps:
  - intent: consultar_recomendaciones_oferta
  - action: action_recomendaciones

- story: recomendaciones_tras_busqueda
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: consultar_recomendaciones_producto
  - action: action_recomendaciones

- story: recomendaciones_tras_modificacion
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion
  - intent: consultar_recomendaciones_producto
  - action: action_recomendaciones

# -------------------------
# TRANSICIONES ENTRE B칔SQUEDAS
# -------------------------
- story: cambio_producto_a_oferta
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: buscar_oferta
  - action: action_busqueda_situacion

- story: cambio_oferta_a_producto
  steps:
  - intent: buscar_oferta
  - action: action_busqueda_situacion
  - intent: buscar_producto
  - action: action_busqueda_situacion

- story: busqueda_modificar_nueva_busqueda
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion
  - intent: buscar_oferta              # Nueva b칰squeda despu칠s de modificar
  - action: action_busqueda_situacion

- story: modificar_a_recomendaciones
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion
  - intent: consultar_recomendaciones_producto
  - action: action_recomendaciones

# -------------------------
# CONFIRMACIONES Y RESPUESTAS (SIN COMPLETAR_PEDIDO)
# -------------------------
- story: afirmacion_tras_busqueda
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: afirmar
  - action: action_conf_neg_agradecer

- story: negacion_tras_busqueda
  steps:
  - intent: buscar_oferta
  - action: action_busqueda_situacion
  - intent: denegar
  - action: action_conf_neg_agradecer

- story: afirmacion_luego_modificar
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: afirmar                   # Acepta sugerencia
  - action: action_conf_neg_agradecer
  - intent: modificar_busqueda        # Luego modifica b칰squeda
  - action: action_busqueda_situacion

- story: negacion_luego_modificar
  steps:
  - intent: buscar_oferta
  - action: action_busqueda_situacion
  - intent: denegar                   # Rechaza sugerencia
  - action: action_conf_neg_agradecer
  - intent: modificar_busqueda        # Luego modifica b칰squeda
  - action: action_busqueda_situacion

# -------------------------
# M칔LTIPLES B칔SQUEDAS Y MODIFICACIONES
# -------------------------
- story: busqueda_multiple_con_modificaciones
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion
  - intent: buscar_producto           # Nueva b칰squeda
  - action: action_busqueda_situacion
  - intent: modificar_busqueda        # Modificar la nueva
  - action: action_busqueda_situacion

- story: ciclo_busqueda_modificacion
  steps:
  - intent: buscar_oferta
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion
  - intent: modificar_busqueda        # Otra modificaci칩n
  - action: action_busqueda_situacion
  - intent: buscar_oferta             # Nueva b칰squeda similar
  - action: action_busqueda_situacion

# -------------------------
# PATRONES DE REFINAMIENTO
# -------------------------
- story: refinamiento_progresivo
  steps:
  - intent: buscar_producto           # B칰squeda inicial vaga
  - action: action_busqueda_situacion
  - intent: modificar_busqueda        # Agregar m치s criterios
  - action: action_busqueda_situacion
  - intent: modificar_busqueda        # Refinar a칰n m치s
  - action: action_busqueda_situacion

- story: refinamiento_oferta
  steps:
  - intent: buscar_oferta             # B칰squeda inicial de ofertas
  - action: action_busqueda_situacion
  - intent: modificar_busqueda        # Especificar criterios
  - action: action_busqueda_situacion

- story: cambio_criterios_completo
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: modificar_busqueda        # Cambia completamente los criterios
  - action: action_busqueda_situacion

# -------------------------
# DESPEDIDAS
# -------------------------
- story: despedida_simple
  steps:
  - intent: despedida
  - action: action_context_validator
  - action: action_despedida_limpia_contexto

- story: despedida_durante_busqueda
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: despedida
  - action: action_context_validator
  - action: action_despedida_limpia_contexto

- story: despedida_tras_modificacion
  steps:
  - intent: buscar_oferta
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion
  - intent: despedida
  - action: action_context_validator
  - action: action_despedida_limpia_contexto

# -------------------------
# MANEJO DE ENTIDADES INV츼LIDAS CON MODIFICAR
# -------------------------
- story: entidad_invalida_luego_modificar
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion  # Genera sugerencia por entidad inv치lida
  - intent: modificar_busqueda        # Usuario modifica en lugar de responder sugerencia
  - action: action_busqueda_situacion

- story: sugerencia_rechazada_modificar
  steps:
  - intent: buscar_oferta
  - action: action_busqueda_situacion  # Genera sugerencia
  - intent: denegar                   # Rechaza sugerencia
  - action: action_conf_neg_agradecer
  - intent: modificar_busqueda        # Modifica b칰squeda
  - action: action_busqueda_situacion

- story: sugerencia_aceptada_luego_modificar
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion  # Genera sugerencia
  - intent: afirmar                   # Acepta sugerencia
  - action: action_conf_neg_agradecer
  - intent: modificar_busqueda        # Luego modifica para agregar m치s criterios
  - action: action_busqueda_situacion

# -------------------------
# RECOVERY PATTERNS SIMPLIFICADOS
# -------------------------
- story: recovery_desde_fallback_buscar
  steps:
  - action: action_fallback
  - intent: buscar_producto
  - action: action_busqueda_situacion

- story: recovery_desde_fallback_modificar
  steps:
  - action: action_fallback
  - intent: modificar_busqueda
  - action: action_busqueda_situacion

- story: recovery_smalltalk_modificar
  steps:
  - intent: pedir_chiste
  - action: action_smalltalk_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion

# -------------------------
# PATRONES DE CONTINUIDAD SIN COMPLETAR
# -------------------------
- story: continuidad_busqueda_modificacion
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion

- story: continuidad_mixta
  steps:
  - intent: buscar_oferta
  - action: action_busqueda_situacion
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: modificar_busqueda
  - action: action_busqueda_situacion

# -------------------------
# MODIFICAR DESPU칄S DE CONFIRMACIONES
# -------------------------
- story: confirmar_luego_modificar_mas
  steps:
  - intent: buscar_producto
  - action: action_busqueda_situacion
  - intent: afirmar                   # Confirma resultados
  - action: action_conf_neg_agradecer
  - intent: modificar_busqueda        # Pero quiere agregar m치s criterios
  - action: action_busqueda_situacion

- story: negar_y_modificar_completamente
  steps:
  - intent: buscar_oferta
  - action: action_busqueda_situacion
  - intent: denegar                   # No le gustan los resultados
  - action: action_conf_neg_agradecer
  - intent: modificar_busqueda        # Cambia completamente la b칰squeda
  - action: action_busqueda_situacion