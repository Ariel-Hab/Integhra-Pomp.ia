version: '3.1'
config:
  store_entities_as_slots: true
  fallback_action: action_fallback

intents:
  #- saludo
  - saludar
  - despedida
  #- agradecimiento
  - agradecer 
  - preguntar_como_estas
  - responder_como_estoy
  - pedir_chiste
  - reirse_chiste
  - responder_estoy_bien
  - buscar_producto
  - buscar_oferta
  - consultar_novedades_producto  
  - consultar_novedades_oferta    
  - modificar_busqueda
  - afirmar
  - denegar
  - completar_pedido
  - off_topic
  - out_of_scope
  - ambiguity_fallback

entities:
  # ✅ Entidades principales simplificadas
  - producto
  
  # 🆕 EMPRESA CON ROL
  - empresa:
      roles:
        - proveedor
  
  - categoria
  - animal
  - sintoma
  - dosis
  
  # 🆕 ESTADO CON 4 ROLES
  - estado:
      roles:
        - nuevo
        - poco_stock
        - vence_pronto
        - en_oferta
  
  # ✅ Entidades numéricas/comparativas que faltaban
  - cantidad
  - precio
  - descuento                  # ✅ Simplificado (antes cantidad_descuento)
  - bonificacion              # ✅ Simplificado (antes cantidad_bonificacion)  
  - stock                     # ✅ Simplificado (antes cantidad_stock)
  - comparador
  
  # ✅ Entidades temporales
  - tiempo
  - fecha
  - dia
  
  # ✅ Entidades de contexto
  - sentimiento

slots:
  # --- Slots principales ---
  producto:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: producto

  empresa:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: empresa

  # 🆕 SLOT PARA ROL DE EMPRESA (OPCIONAL)
  empresa_role:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: empresa
        role: proveedor

  categoria:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: categoria

  animal:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: animal

  sintoma:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: sintoma

  dosis:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: dosis

  estado:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: estado

  # 🆕 SLOTS PARA ROLES DE ESTADO (OPCIONAL PERO ÚTIL)
  estado_role:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: estado
        role: nuevo
      - type: from_entity
        entity: estado
        role: poco_stock
      - type: from_entity
        entity: estado
        role: vence_pronto
      - type: from_entity
        entity: estado
        role: en_oferta

  # --- Slots numéricos/comparativos ---
  cantidad:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: cantidad

  precio:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: precio

  descuento:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: descuento

  bonificacion:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: bonificacion

  stock:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: stock

  comparador:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: comparador

  # --- Slots temporales ---
  tiempo:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: tiempo

  fecha:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: fecha

  dia:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: dia

  sentimiento:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: sentimiento

  # --- Slots de control de conversación ---
  last_intent_flow:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text

  user_engagement_level:
    type: categorical
    influence_conversation: false
    values:
      - neutral
      - engaged
      - needs_help
      - confused
      - friendly
      - collaborative
      - reset
      - disengaged
      - interested
      - needs_guidance
      - satisfied
      - awaiting_confirmation
      - awaiting_parameters
    initial_value: neutral
    mappings:
      - type: from_entity
        entity: user_engagement_level

  current_search_params:
    type: any
    influence_conversation: false
    initial_value: {}
    mappings: []

  search_active:
    type: bool
    influence_conversation: true
    initial_value: false
    mappings:
      - type: from_intent
        value: true
        intent: buscar_producto
      - type: from_intent
        value: true
        intent: buscar_oferta
      - type: from_intent
        value: false
        intent: despedida

  last_search_type:
    type: text
    influence_conversation: true
    initial_value: null
    mappings:
      - type: from_text
  
  # --- Slots faltantes reportados por logs ---
  user_sentiment:
    type: text
    influence_conversation: false
    initial_value: null
    mappings: []

  pending_suggestion:
    type: text
    influence_conversation: true
    initial_value: null
    mappings: 
      - type: custom

  suggestion_context:
    type: text
    influence_conversation: false
    initial_value: null
    mappings: []

  search_history:
    type: any
    influence_conversation: false
    initial_value: []
    mappings: []

  context_decision_pending:
    type: bool
    influence_conversation: false
    initial_value: false
    mappings: []

  validation_errors:
    type: any
    influence_conversation: false
    initial_value: []
    mappings: []


responses:
  utter_saludo:
  - text: ¡Hola!🐶
  - text: Buenas, un gusto saludarte 🐾
  - text: ¡Hola! Encantado de verte por acá 🐾
  utter_responder_como_estoy:
  - text: Espectacular!
  - text: Guau! Me alegro 🐶
  - text: ¡Sigue así! 💪
  - text: ¡Eres un campeón! 🏆
  utter_reirse_chiste:
  - text: 😄 Me alegra que te haya sacado una sonrisa
  - text: 😂 jajaja, buenísimo
  utter_preguntar_como_estas:
  - text: ¡Todo bien! ¿Y vos?
  utter_responder_estoy_bien:
  - text: Espectacular! Necesitas buscar algo?
  - text: Buenisimoo! Necesitas ayuda?
  - text: Genial! Estoy aquí por si necesitas algo
  utter_pedir_chiste:
  - text: 'Aquí va uno: —Doctor, mi perro no deja de perseguir bicicletas. —¿Y qué
      hizo? —Vendí la bicicleta.'
  - text: 'Aquí va uno: ¿Por qué el gato no trabaja en la computadora? Porque le tiene
      miedo al *ratón*.'
  - text: 'Aquí va uno: ¿Cuál es el animal más tecnológico? El *gallo*, porque siempre
      da el primer *click* del día.'
  - text: 'Aquí va uno: ¿Qué hace una vaca cuando escucha música? ¡Da leche condensada!'
  - text: 'Aquí va uno: ¿Por qué el pez nunca estudia? Porque siempre se queda en
      *escuela*.'
  - text: 'Aquí va uno: ¿Qué hace un perro con un taladro? ¡Hace agujeros a lo *guau*!'
  - text: 'Aquí va uno: ¿Cuál es el animal más antiguo? La cebra... porque todavía
      está en blanco y negro.'
  - text: 'Aquí va uno: ¿Por qué el caballo fue a terapia? Porque tenía muchas *cargas
      emocionales*.'
  - text: 'Aquí va uno: ¿Qué hace un conejo cuando se aburre? ¡Ve *zanahorias* películas!'
  - text: 'Aquí va uno: ¿Cómo se despiden dos pulgas? Nos vemos en el perro'
  - text: 'Aquí va uno: ¿Cuál es el animal más ordenado? El perro pastor, siempre
      pone todo en fila.'
  - text: 'Aquí va uno: ¿Por qué el loro nunca aprueba exámenes? Porque siempre repite.'
  - text: 'Aquí va uno: ¿Qué le dijo el gato al veterinario? ¡Hoy vengo por curiosidad!'
  - text: 'Aquí va uno: ¿Cuál es el pez más gracioso? El *pez payaso*... pero siempre
      hace chistes *de mal gusto*.'
  - text: 'Aquí va uno: ¿Qué hace un perro frente al aire acondicionado? ¡Esperar
      que le dé un poco de *fres-canis*!'
  - text: 'Aquí va uno: ¿Cómo llaman a un perro que sabe cantar? ¡Un *can-tante* profesional!'
  - text: 'Aquí va uno: ¿Por qué los pollitos no usan Facebook? Porque ya tienen *pío-pío*.'
  - text: 'Aquí va uno: ¿Qué le dice una oveja presumida a otra? ¡Soy la oveja más
      *cool-la* del rebaño!'
  - text: 'Aquí va uno: ¿Cómo se llama el gato que hace magia? ¡Miau-dini!'
  - text: 'Aquí va uno: ¿Por qué la vaca fue astronauta? Porque quería ver la *Vía
      Láctea* desde arriba.'
  utter_despedida:
  - text: ¡Adiós! Que tengas un gran día ✨
  - text: Hasta luego, nos vemos pronto 🐾
  - text: Chao, cuidate mucho
  utter_denegar:
  - text: Está bien, lo respeto 👍
  - text: Perfecto, no hay problema
  - text: De acuerdo, entendido
  utter_agradecimiento:
  - text: ¡De nada! 😊
  - text: Siempre a disposición 🙌
  - text: Me alegra poder ayudarte
  utter_afirmar:
  - text: ¡Perfecto!
  - text: Genial, entendido 👍
  - text: Claro que sí
  utter_pedir_parametros_producto:
  - text: |
      Para buscar un producto necesito al menos un dato 🛒  
      Ejemplo ➡️ nombre del producto, categoría, ingrediente activo o animal.  
      ¿Cuál me pasás?

  utter_pedir_parametros_oferta:
    - text: |
        Para mostrarte ofertas necesito saber algun dato **de qué producto o categoría** 👌  
        ¿Cuál te interesa?

  utter_pedir_criterio_oferta:
    - text: |
        ¿Qué tipo de oferta buscás? 🎯  
        🔹 descuento  
        🔹 bonificación  
        🔹 o una fecha específica  
        Así te muestro las más relevantes.

  # 🆕 NUEVAS RESPUESTAS PARA RECOMENDACIONES UNIFICADAS
  utter_recomendaciones_no_disponible:
  - text: |
      Entiendo que buscás recomendaciones 🎯 
      Por el momento esta funcionalidad no está disponible, pero puedo ayudarte a buscar productos específicos o ver ofertas actuales.
      ¿Te interesa que busquemos algo en particular?
  - text: |
      Perfecto, capturo que querés recomendaciones 💡 
      Esa función está en desarrollo aún. Mientras tanto, puedo mostrarte productos por categoría o buscar ofertas.
      ¿Qué prefieres?
  - text: |
      ¡Claro! Te entiendo, buscás que te recomiende algo 🤝 
      Esa característica no está lista todavía, pero sí puedo ayudarte a encontrar productos si me decís qué necesitás.
      ¿Para qué animal o qué tipo de producto buscás?
      
actions:
  - action_busqueda_situacion
  - action_conf_neg_agradecer
  - action_context_validator
  - action_despedida_limpia_contexto
  - action_fallback
  - action_smalltalk_situacion
  - action_recomendaciones

session_config:
  session_expiration_time: 300
  carry_over_slots_to_new_session: true