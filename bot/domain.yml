version: '3.1'
config:
  store_entities_as_slots: true
  fallback_action: action_fallback

intents:
  #- saludo
  - saludar
  - despedida
  #- agradecimiento
  - agradecer 
  - preguntar_como_estas
  - responder_como_estoy
  - pedir_chiste
  - reirse_chiste
  - responder_estoy_bien
  - buscar_producto
  - buscar_oferta
  - consultar_novedades_producto  
  - consultar_novedades_oferta    
  - modificar_busqueda
  - afirmar
  - denegar
  - completar_pedido
  - off_topic
  - out_of_scope
  - ambiguity_fallback

entities:
  # âœ… Entidades principales simplificadas
  - producto
  
  # ğŸ†• EMPRESA CON ROL
  - empresa:
      roles:
        - proveedor
  
  - categoria
  - animal
  - sintoma
  - dosis
  
  # ğŸ†• ESTADO CON 4 ROLES
  - estado:
      roles:
        - nuevo
        - poco_stock
        - vence_pronto
        - en_oferta
  
  # âœ… Entidades numÃ©ricas/comparativas que faltaban
  - cantidad
  - precio
  - descuento                  # âœ… Simplificado (antes cantidad_descuento)
  - bonificacion              # âœ… Simplificado (antes cantidad_bonificacion)  
  - stock                     # âœ… Simplificado (antes cantidad_stock)
  - comparador
  
  # âœ… Entidades temporales
  - tiempo
  - fecha
  - dia
  
  # âœ… Entidades de contexto
  - sentimiento

slots:
  # --- Slots principales ---
  producto:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: producto

  empresa:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: empresa

  # ğŸ†• SLOT PARA ROL DE EMPRESA (OPCIONAL)
  empresa_role:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: empresa
        role: proveedor

  categoria:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: categoria

  animal:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: animal

  sintoma:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: sintoma

  dosis:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: dosis

  estado:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: estado

  # ğŸ†• SLOTS PARA ROLES DE ESTADO (OPCIONAL PERO ÃšTIL)
  estado_role:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: estado
        role: nuevo
      - type: from_entity
        entity: estado
        role: poco_stock
      - type: from_entity
        entity: estado
        role: vence_pronto
      - type: from_entity
        entity: estado
        role: en_oferta

  # --- Slots numÃ©ricos/comparativos ---
  cantidad:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: cantidad

  precio:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: precio

  descuento:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: descuento

  bonificacion:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: bonificacion

  stock:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: stock

  comparador:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: comparador

  # --- Slots temporales ---
  tiempo:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: tiempo

  fecha:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: fecha

  dia:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: dia

  sentimiento:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: sentimiento

  # --- Slots de control de conversaciÃ³n ---
  last_intent_flow:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text

  user_engagement_level:
    type: categorical
    influence_conversation: false
    values:
      - neutral
      - engaged
      - needs_help
      - confused
      - friendly
      - collaborative
      - reset
      - disengaged
      - interested
      - needs_guidance
      - satisfied
      - awaiting_confirmation
      - awaiting_parameters
    initial_value: neutral
    mappings:
      - type: from_entity
        entity: user_engagement_level

  current_search_params:
    type: any
    influence_conversation: false
    initial_value: {}
    mappings: []

  search_active:
    type: bool
    influence_conversation: true
    initial_value: false
    mappings:
      - type: from_intent
        value: true
        intent: buscar_producto
      - type: from_intent
        value: true
        intent: buscar_oferta
      - type: from_intent
        value: false
        intent: despedida

  last_search_type:
    type: text
    influence_conversation: true
    initial_value: null
    mappings:
      - type: from_text
  
  # --- Slots faltantes reportados por logs ---
  user_sentiment:
    type: text
    influence_conversation: false
    initial_value: null
    mappings: []

  pending_suggestion:
    type: text
    influence_conversation: true
    initial_value: null
    mappings: 
      - type: custom

  suggestion_context:
    type: text
    influence_conversation: false
    initial_value: null
    mappings: []

  search_history:
    type: any
    influence_conversation: false
    initial_value: []
    mappings: []

  context_decision_pending:
    type: bool
    influence_conversation: false
    initial_value: false
    mappings: []

  validation_errors:
    type: any
    influence_conversation: false
    initial_value: []
    mappings: []


responses:
  utter_saludo:
  - text: Â¡Hola!ğŸ¶
  - text: Buenas, un gusto saludarte ğŸ¾
  - text: Â¡Hola! Encantado de verte por acÃ¡ ğŸ¾
  utter_responder_como_estoy:
  - text: Espectacular!
  - text: Guau! Me alegro ğŸ¶
  - text: Â¡Sigue asÃ­! ğŸ’ª
  - text: Â¡Eres un campeÃ³n! ğŸ†
  utter_reirse_chiste:
  - text: ğŸ˜„ Me alegra que te haya sacado una sonrisa
  - text: ğŸ˜‚ jajaja, buenÃ­simo
  utter_preguntar_como_estas:
  - text: Â¡Todo bien! Â¿Y vos?
  utter_responder_estoy_bien:
  - text: Espectacular! Necesitas buscar algo?
  - text: Buenisimoo! Necesitas ayuda?
  - text: Genial! Estoy aquÃ­ por si necesitas algo
  utter_pedir_chiste:
  - text: 'AquÃ­ va uno: â€”Doctor, mi perro no deja de perseguir bicicletas. â€”Â¿Y quÃ©
      hizo? â€”VendÃ­ la bicicleta.'
  - text: 'AquÃ­ va uno: Â¿Por quÃ© el gato no trabaja en la computadora? Porque le tiene
      miedo al *ratÃ³n*.'
  - text: 'AquÃ­ va uno: Â¿CuÃ¡l es el animal mÃ¡s tecnolÃ³gico? El *gallo*, porque siempre
      da el primer *click* del dÃ­a.'
  - text: 'AquÃ­ va uno: Â¿QuÃ© hace una vaca cuando escucha mÃºsica? Â¡Da leche condensada!'
  - text: 'AquÃ­ va uno: Â¿Por quÃ© el pez nunca estudia? Porque siempre se queda en
      *escuela*.'
  - text: 'AquÃ­ va uno: Â¿QuÃ© hace un perro con un taladro? Â¡Hace agujeros a lo *guau*!'
  - text: 'AquÃ­ va uno: Â¿CuÃ¡l es el animal mÃ¡s antiguo? La cebra... porque todavÃ­a
      estÃ¡ en blanco y negro.'
  - text: 'AquÃ­ va uno: Â¿Por quÃ© el caballo fue a terapia? Porque tenÃ­a muchas *cargas
      emocionales*.'
  - text: 'AquÃ­ va uno: Â¿QuÃ© hace un conejo cuando se aburre? Â¡Ve *zanahorias* pelÃ­culas!'
  - text: 'AquÃ­ va uno: Â¿CÃ³mo se despiden dos pulgas? Nos vemos en el perro'
  - text: 'AquÃ­ va uno: Â¿CuÃ¡l es el animal mÃ¡s ordenado? El perro pastor, siempre
      pone todo en fila.'
  - text: 'AquÃ­ va uno: Â¿Por quÃ© el loro nunca aprueba exÃ¡menes? Porque siempre repite.'
  - text: 'AquÃ­ va uno: Â¿QuÃ© le dijo el gato al veterinario? Â¡Hoy vengo por curiosidad!'
  - text: 'AquÃ­ va uno: Â¿CuÃ¡l es el pez mÃ¡s gracioso? El *pez payaso*... pero siempre
      hace chistes *de mal gusto*.'
  - text: 'AquÃ­ va uno: Â¿QuÃ© hace un perro frente al aire acondicionado? Â¡Esperar
      que le dÃ© un poco de *fres-canis*!'
  - text: 'AquÃ­ va uno: Â¿CÃ³mo llaman a un perro que sabe cantar? Â¡Un *can-tante* profesional!'
  - text: 'AquÃ­ va uno: Â¿Por quÃ© los pollitos no usan Facebook? Porque ya tienen *pÃ­o-pÃ­o*.'
  - text: 'AquÃ­ va uno: Â¿QuÃ© le dice una oveja presumida a otra? Â¡Soy la oveja mÃ¡s
      *cool-la* del rebaÃ±o!'
  - text: 'AquÃ­ va uno: Â¿CÃ³mo se llama el gato que hace magia? Â¡Miau-dini!'
  - text: 'AquÃ­ va uno: Â¿Por quÃ© la vaca fue astronauta? Porque querÃ­a ver la *VÃ­a
      LÃ¡ctea* desde arriba.'
  utter_despedida:
  - text: Â¡AdiÃ³s! Que tengas un gran dÃ­a âœ¨
  - text: Hasta luego, nos vemos pronto ğŸ¾
  - text: Chao, cuidate mucho
  utter_denegar:
  - text: EstÃ¡ bien, lo respeto ğŸ‘
  - text: Perfecto, no hay problema
  - text: De acuerdo, entendido
  utter_agradecimiento:
  - text: Â¡De nada! ğŸ˜Š
  - text: Siempre a disposiciÃ³n ğŸ™Œ
  - text: Me alegra poder ayudarte
  utter_afirmar:
  - text: Â¡Perfecto!
  - text: Genial, entendido ğŸ‘
  - text: Claro que sÃ­
  utter_pedir_parametros_producto:
  - text: |
      Para buscar un producto necesito al menos un dato ğŸ›’  
      Ejemplo â¡ï¸ nombre del producto, categorÃ­a, ingrediente activo o animal.  
      Â¿CuÃ¡l me pasÃ¡s?

  utter_pedir_parametros_oferta:
    - text: |
        Para mostrarte ofertas necesito saber algun dato **de quÃ© producto o categorÃ­a** ğŸ‘Œ  
        Â¿CuÃ¡l te interesa?

  utter_pedir_criterio_oferta:
    - text: |
        Â¿QuÃ© tipo de oferta buscÃ¡s? ğŸ¯  
        ğŸ”¹ descuento  
        ğŸ”¹ bonificaciÃ³n  
        ğŸ”¹ o una fecha especÃ­fica  
        AsÃ­ te muestro las mÃ¡s relevantes.

  # ğŸ†• NUEVAS RESPUESTAS PARA RECOMENDACIONES UNIFICADAS
  utter_recomendaciones_no_disponible:
  - text: |
      Entiendo que buscÃ¡s recomendaciones ğŸ¯ 
      Por el momento esta funcionalidad no estÃ¡ disponible, pero puedo ayudarte a buscar productos especÃ­ficos o ver ofertas actuales.
      Â¿Te interesa que busquemos algo en particular?
  - text: |
      Perfecto, capturo que querÃ©s recomendaciones ğŸ’¡ 
      Esa funciÃ³n estÃ¡ en desarrollo aÃºn. Mientras tanto, puedo mostrarte productos por categorÃ­a o buscar ofertas.
      Â¿QuÃ© prefieres?
  - text: |
      Â¡Claro! Te entiendo, buscÃ¡s que te recomiende algo ğŸ¤ 
      Esa caracterÃ­stica no estÃ¡ lista todavÃ­a, pero sÃ­ puedo ayudarte a encontrar productos si me decÃ­s quÃ© necesitÃ¡s.
      Â¿Para quÃ© animal o quÃ© tipo de producto buscÃ¡s?
      
actions:
  - action_busqueda_situacion
  - action_conf_neg_agradecer
  - action_context_validator
  - action_despedida_limpia_contexto
  - action_fallback
  - action_smalltalk_situacion
  - action_recomendaciones

session_config:
  session_expiration_time: 300
  carry_over_slots_to_new_session: true